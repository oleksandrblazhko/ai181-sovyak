###    

| Ідентифікатор та назва атаки (вразливості)                                                                             | Вимога (FR, NFR)                                                                                                                                                                                                                                                                                                                             | Приклад вразливостей, які може використовувати атака                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Приклад запобігання успішної реалізації атаки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|:-----------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
 | A1 – недоліки контролю доступу (Broken Access Control)                                                                 | FR1 – Функція реєстрації користувача <br/>FR2 – Функція авторизації користувача <br/>FR3 – Функція повідомлення користувачем про появу нової потенційно небезпечної зони <br/>FR6 – Функція оновлення даних щодо небезпечних зон                                                                                                             | Маніпуляція метаданими, як-от повторне відтворення чи підробка маркера керування доступом JSON Web Token (JWT), файли cookie або приховані поля, маніпульовані з метою підвищення привілеїв або зловживання недійсністю JWT.                                                                                                                                                                                                                                                                                                                                                            | Ідентифікатори сеансу з підтримкою стану мають бути визнані недійсними на сервері після виходу з системи. Токени JWT без стану повинні бути короткочасними, щоб мінімізувати вікно можливостей для зловмисника. Для довготривалих JWT настійно рекомендується дотримуватися стандартів OAuth, щоб скасувати доступ.                                                                                                                                                                                                                                      |
| A2 – невдачі (збої) у криптографії (Cryptographic Failures)                                                            | FR1 – Функція реєстрації користувача <br/>FR2 – Функція авторизації користувача                                                                                                                                                                                                                                                              | Передача відкритих данних через інтернет протокол.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Забезпечити наявність актуальних і надійних стандартних алгоритмів, протоколів і ключів; використовувати правильне керування ключами.                                                                                                                                                                                                                                                                                                                                                                                                                    |
| A3 – впровадження (Injection)                                                                                          |                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Використано безпечний API, який повністю уникає використання інтерпретатора, надає параметризований інтерфейс або переходить на інструменти відображення об’єктів (ORM).                                                                                                                                                                                                                                                                                                                                                                                 |
| A4 – небезпечний дизайн (Insecure Design)                                                                              | FR1 – Функція реєстрації користувача <br/>FR2 – Функція авторизації користувача <br/>FR3 – Функція повідомлення користувачем про появу нової потенційно небезпечної зони <br/>FR6 – Функція оновлення даних щодо небезпечних зон <br/>FR8 – Функція обробки модератором даних про зони <br/> FR9 – Функція контролю користувачів модератором | Виконання послідовності дій, які можуть призвести до помилок, втрати цілісності даних або їх повної втрати.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Напишіть модульні та інтеграційні тести, щоб підтвердити, що всі критичні потоки стійкі до моделі загроз. Зберіть випадки використання та випадки неправильного використання для кожного рівня вашої програми.                                                                                                                                                                                                                                                                                                                                           |
| A6 – вразливі та застарілі компоненти (Vulnerable and Outdated Components)                                             |                                                                                                                                                                                                                                                                                                                                              | Якщо ви не знаєте версії всіх компонентів, які використовуєте (як на стороні клієнта, так і на стороні сервера). Це включає компоненти, які ви використовуєте безпосередньо, а також вкладені залежності. Якщо програмне забезпечення є вразливим, не підтримується або застаріло. Це включає ОС, веб-сервер/сервер додатків, систему керування базами даних (СУБД), програми, API та всі компоненти, середовища виконання та бібліотеки. Якщо ви не скануєте на наявність уразливостей регулярно та підписуєтеся на бюлетені безпеки, пов’язані з компонентами, які ви використовуєте. | Видаліть невикористовувані залежності, непотрібні функції, компоненти, файли та документацію. Отримуйте компоненти лише з офіційних джерел через безпечні посилання. Віддавайте перевагу підписаним пакетам, щоб зменшити ймовірність включення модифікованого шкідливого компонента. Слідкуйте за бібліотеками та компонентами, які не обслуговуються або не створюють виправлення безпеки для старіших версій. Якщо виправлення неможливо, подумайте про розгортання віртуального патча для моніторингу, виявлення або захисту від виявленої проблеми. |
| A7 – помилки ідентифікації та аутентифікації (Identification and Authentication Failures)                              | FR2 – Функція авторизації користувача                                                                                                                                                                                                                                                                                                        | Відсутня або неефективна багатофакторна автентифікація.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Якщо це можливо, застосувати багатофакторну автентифікацію, щоб запобігти автоматизованому підкиданню облікових даних, грубій форсації та атакам повторного використання вкрадених облікових даних.                                                                                                                                                                                                                                                                                                                                                      |
| A8 – невдачі (збої) у забезпеченні цілісності програмного забезпечення та даних (Software and Data Integrity Failures) | FR1 – Функція реєстрації користувача <br/>FR2 – Функція авторизації користувача <br/>FR3 – Функція повідомлення користувачем про появу нової потенційно небезпечної зони <br/>FR6 – Функція оновлення даних щодо небезпечних зон                                                                                                             | Порушення цілісності програмного забезпечення та даних стосуються коду та інфраструктури, які не захищають від порушень цілісності. Прикладом цього є ситуація, коли програма використовує плагіни, бібліотеки або модулі з ненадійних джерел, сховищ і мереж доставки вмісту (CDN). Незахищений конвеєр CI/CD може призвести до несанкціонованого доступу, зловмисного коду або компрометації системи. Прикладом є те, що об’єкти чи дані кодуються або серіалізуються в структуру, яку зловмисник може побачити та змінити, вразливу до незахищеної десеріалізації.                   | Використовуйте цифрові підписи або подібні механізми, щоб переконатися, що програмне забезпечення або дані походять з очікуваного джерела та не були змінені. Переконайтеся, що непідписані або незашифровані серіалізовані дані не надсилаються ненадійним клієнтам без певної форми перевірки цілісності або цифрового підпису для виявлення підробки або повторного відтворення серіалізованих даних                                                                                                                                                  |
| A9 – невдачі (збої) реєстрації та моніторингу безпеки (Security Logging and Monitoring Failures)                       | FR1 – Функція реєстрації користувача <br/>FR2 – Функція авторизації користувача                                                                                                                                                                                                                                                              | Події, які підлягають аудиту, як-от входи, невдалі входи та транзакції великої вартості, не реєструються. Програма не може виявляти, ескалувати або сповіщати про активні атаки в режимі реального часу або майже в реальному часі.                                                                                                                                                                                                                                                                                                                                                     | Переконайтеся, що всі помилки входу, контролю доступу та перевірки введення на стороні сервера можна реєструвати з достатнім контекстом користувача для ідентифікації підозрілих або зловмисних облікових записів і зберігати протягом достатнього часу, щоб забезпечити відкладений криміналістичний аналіз. Команди DevSecOps повинні налагодити ефективний моніторинг і попередження, щоб підозрілі дії виявлялися та швидко реагували на них.                                                                                                        |
| A10 – підробка запитів на стороні сервера (Server-Side Request Forgery)                                                | FR1 – Функція реєстрації користувача <br/>FR2 – Функція авторизації користувача <br/>FR3 – Функція повідомлення користувачем про появу нової потенційно небезпечної зони <br/>FR6 – Функція оновлення даних щодо небезпечних зон                                                                                                             | Помилки SSRF виникають щоразу, коли веб-програма отримує віддалений ресурс без перевірки наданої користувачем URL-адреси. Це дозволяє зловмиснику змусити програму надіслати створений запит до неочікуваного адресата, навіть якщо він захищений брандмауером, VPN або іншим типом списку контролю доступу до мережі (ACL).Оскільки сучасні веб-додатки надають кінцевим користувачам зручні функції, отримання URL-адреси стає звичайним сценарієм. Як наслідок, захворюваність на SSRF зростає. Крім того, серйозність SSRF стає вищою через хмарні сервіси та складність архітектур. | Очистіть і перевірте всі вхідні дані, надані клієнтом. Застосуйте схему URL-адреси, порт і призначення за допомогою позитивного дозволеного списку. Не надсилайте необроблені відповіді клієнтам. Не пом’якшуйте SSRF за допомогою списку заборони або регулярного виразу. Зловмисники мають списки корисного навантаження, інструменти та навички для обходу списків заборонених.                                                                                                                                                                       |
